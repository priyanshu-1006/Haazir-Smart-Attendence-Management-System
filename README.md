# 🎓 Haazir - Smart Attendance Management System

[![TypeScript](https://img.shields.io/badge/TypeScript-007ACC?logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![React](https://img.shields.io/badge/React-61DAFB?logo=react&logoColor=black)](https://reactjs.org/)
[![Node.js](https://img.shields.io/badge/Node.js-339933?logo=node.js&logoColor=white)](https://nodejs.org/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-4169E1?logo=postgresql&logoColor=white)](https://www.postgresql.org/)
[![TensorFlow.js](https://img.shields.io/badge/TensorFlow.js-FF6F00?logo=tensorflow&logoColor=white)](https://www.tensorflow.org/js)

**Haazir** (Hindi: हाज़िर, meaning "Present") is a comprehensive, AI-powered attendance management and timetable optimization system designed for educational institutions. Built with modern web technologies and advanced AI algorithms, Haazir streamlines attendance tracking, automates timetable generation, and provides insightful analytics for coordinators, teachers, and students.

---

## 🌟 Key Features

### 🎯 **Multi-Role Authentication & Authorization**
- **Three distinct user roles:** Coordinator, Teacher, and Student
- JWT-based secure authentication with role-based access control (RBAC)
- Profile management with customizable user settings
- Session management with token refresh capabilities

### 🤖 **AI-Powered Smart Attendance**
#### QR Code + Face Recognition Dual Verification
- **Step 1:** Students scan QR code generated by teacher
- **Step 2:** Real-time facial recognition verification using Face-API.js
- **Biometric Security:** Face embeddings stored as 128-dimensional vectors
- **Location Tracking:** GPS-based attendance verification with distance validation
- **Anti-Spoofing:** Multiple face samples required (minimum 3) during enrollment
- **Session Management:** Time-bound attendance sessions (90-second windows)

#### Face Enrollment System
- Multi-angle face capture (3+ samples required)
- Real-time face detection and validation
- Secure storage of facial embeddings (no raw images stored)
- Support for both webcam capture and photo upload

### 📊 **Intelligent Timetable Generation**
#### AI-Powered CSP (Constraint Satisfaction Problem) Solver
- **Hard Constraints Enforcement:**
  - No teacher double-booking
  - No room conflicts
  - No section scheduling conflicts
  - Teacher availability windows
  - Room capacity and type requirements

- **Soft Constraints Optimization:**
  - Minimize teacher idle gaps
  - Balanced daily workload distribution
  - Preferred time slot allocation
  - Sequential lab sessions
  - Lunch break preservation

- **Multi-Solution Generation:**
  - Generates 3+ different timetable solutions
  - AI-powered recommendations for best timetable
  - Comparison of solutions based on optimization metrics
  - One-click deployment of approved timetables

#### Advanced Timetable Features
- **Batch and Section Management:** Support for multiple sections per semester
- **Session Types:** Theory, Lab, Tutorial classes with custom durations
- **Flexible Scheduling:** Support for 30-minute to multi-hour sessions
- **Room Management:** Automatic room allocation based on requirements
- **Target Audience:** Class-specific or department-wide sessions

### 📈 **Comprehensive Analytics Dashboard**
#### Coordinator Dashboard
- Department-wide attendance statistics
- Student enrollment trends
- Teacher performance metrics
- Course-wise attendance reports
- Real-time alerts and notifications
- Bulk operations (student enrollment, course assignments)

#### Teacher Dashboard
- Class-wise attendance tracking
- Multiple attendance marking methods:
  - Smart QR + Face verification
  - Traditional manual attendance
  - Bulk photo-based attendance (class photo analysis)
- Attendance history with calendar view
- Student performance analytics
- Course management tools

#### Student Dashboard
- Personal attendance statistics
- Course-wise attendance breakdown
- Detailed attendance history with calendar view
- Timetable access
- Notification center
- Grade tracking
- Face enrollment management

### 📱 **Modern, Responsive UI/UX**
- **Tailwind CSS:** Clean, modern, mobile-first design
- **Framer Motion:** Smooth animations and transitions
- **Chart.js & Recharts:** Interactive data visualizations
- **Lucide Icons:** Consistent iconography
- **Lottie Animations:** Engaging loading states and illustrations
- **Dark Mode Ready:** Theme context with persistent preferences

### 🔔 **Real-Time Notifications**
- In-app notification center
- Attendance session alerts
- Timetable update notifications
- System announcements
- Grade publication alerts

### 📂 **Bulk Operations & Data Management**
- Excel/CSV import for student enrollment
- Bulk course enrollment
- Section-wise student assignment
- Batch management
- Department and course CRUD operations

---

## 🏗️ System Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                         CLIENT LAYER                         │
│  React 18 + TypeScript + Tailwind CSS + TensorFlow.js      │
│                                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │ Coordinator  │  │   Teacher    │  │   Student    │     │
│  │  Dashboard   │  │  Dashboard   │  │  Dashboard   │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Face-API.js   │  QR Scanner  │  Chart.js/Recharts │  │
│  │  (Face Recognition) │ (html5-qrcode) │ (Analytics) │  │
│  └──────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              ↕ HTTP/REST API
┌─────────────────────────────────────────────────────────────┐
│                         SERVER LAYER                         │
│         Node.js + Express + TypeScript                      │
│                                                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │  Auth API    │  │Attendance API│  │ Timetable API│     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │         AI Timetable Generator (CSP Solver)          │  │
│  │  • Hard Constraints  • Soft Constraints              │  │
│  │  • Multi-Solution    • Optimization Scoring          │  │
│  └──────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              ↕ SQL Queries
┌─────────────────────────────────────────────────────────────┐
│                       DATABASE LAYER                         │
│                PostgreSQL (Supabase)                        │
│                                                              │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐      │
│  │  Users   │ │ Students │ │ Teachers │ │ Courses  │      │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘      │
│                                                              │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐      │
│  │Attendance│ │Timetable │ │  Faces   │ │ Sessions │      │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘      │
│                                                              │
│             24 Migration Files • Comprehensive Schema       │
└─────────────────────────────────────────────────────────────┘
```

---

## 🛠️ Tech Stack

### **Frontend**
| Technology | Purpose | Version |
|------------|---------|---------|
| **React** | UI Framework | 18.x |
| **TypeScript** | Type Safety | 4.x |
| **Tailwind CSS** | Styling | 3.4.x |
| **React Router** | Navigation | 5.x |
| **Face-API.js** | Face Recognition | 0.22.x |
| **TensorFlow.js** | ML Backend | 4.10.x |
| **html5-qrcode** | QR Scanning | 2.3.x |
| **Chart.js** | Data Visualization | 4.5.x |
| **Recharts** | Advanced Charts | 3.2.x |
| **Framer Motion** | Animations | 12.x |
| **Axios** | HTTP Client | 1.12.x |
| **Lottie React** | Animations | 2.4.x |

### **Backend**
| Technology | Purpose | Version |
|------------|---------|---------|
| **Node.js** | Runtime | 18+ |
| **Express** | Web Framework | 4.x |
| **TypeScript** | Type Safety | 5.x |
| **PostgreSQL** | Database | 14+ |
| **Sequelize** | ORM | 6.x |
| **JWT** | Authentication | 9.x |
| **bcryptjs** | Password Hashing | 2.x |
| **Multer** | File Uploads | 1.4.x |
| **QRCode** | QR Generation | 1.5.x |
| **Sharp** | Image Processing | 0.34.x |

### **AI/ML Components**
- **CSP Solver**: Custom Constraint Satisfaction Problem solver for timetable optimization
- **Face Recognition**: Face-API.js with 128-dimensional descriptor vectors
- **Genetic Algorithms**: Soft constraint optimization using evolutionary techniques

---

## 📦 Installation & Setup

### **Prerequisites**
```bash
- Node.js >= 18.x
- PostgreSQL >= 14.x (or Supabase account)
- npm or yarn
- Git
```

### **1. Clone Repository**
```bash
git clone https://github.com/priyanshu-1006/Haazir-Smart-Attendence-Management-System.git
cd Haazir-Smart-Attendence-Management-System
```

### **2. Database Setup**

#### **Option A: Local PostgreSQL**
```bash
# Create database
createdb haazir_db

# Run migrations in order
cd database/migrations
psql -d haazir_db -f 001_create_users.sql
psql -d haazir_db -f 002_create_departments.sql
# ... run all migrations in order (001-024)

# Optional: Seed sample data
cd ../seeds
psql -d haazir_db -f sample_data.sql
```

#### **Option B: Supabase**
1. Create a new Supabase project at [supabase.com](https://supabase.com)
2. Copy your database URL from Project Settings → Database
3. Run migrations using Supabase SQL Editor or psql with connection string

### **3. Backend Setup**
```bash
cd server

# Install dependencies
npm install

# Create .env file
cat > .env << EOF
PORT=5001
DB_HOST=localhost
DB_PORT=5432
DB_NAME=haazir_db
DB_USER=your_username
DB_PASSWORD=your_password
JWT_SECRET=your_super_secret_jwt_key_change_this
CORS_ORIGIN=http://localhost:3000
NODE_ENV=development
EOF

# Build TypeScript
npm run build

# Start server
npm run dev
# Server runs on http://localhost:5001
```

### **4. Frontend Setup**
```bash
cd client

# Install dependencies
npm install

# Create .env file
cat > .env << EOF
REACT_APP_API_URL=http://localhost:5001/api
EOF

# Start development server
npm start
# Application opens at http://localhost:3000
```

### **5. Seed Coordinator Account**
```bash
cd server
npm run db:seed:coordinator
```

**Default Coordinator Credentials:**
- Email: `coordinator@iiitg.ac.in`
- Password: `coordinator123`

---

## 🚀 Usage Guide

### **For Coordinators**
1. **Login** with coordinator credentials
2. **Department Setup:**
   - Create departments (CSE, ECE, ME, etc.)
   - Define semesters and sections
   - Manage batches
3. **User Management:**
   - Add teachers (manually or bulk upload)
   - Enroll students (Excel/CSV import supported)
   - Assign students to sections
4. **Course Management:**
   - Create courses with codes and credits
   - Assign teachers to courses
   - Enroll students in courses
5. **Timetable Generation:**
   - Navigate to Smart Timetable Generator
   - Input constraints (time slots, teacher availability, room requirements)
   - Generate multiple solutions
   - Review and approve best timetable
   - Deploy to production

### **For Teachers**
1. **Login** with teacher credentials
2. **View Timetable:** See assigned classes and schedules
3. **Mark Attendance:**
   - **Smart Attendance:**
     - Start QR session for a class
     - Students scan QR + face verification
     - Auto-validation with location checking
   - **Manual Attendance:** Traditional roll-call method
   - **Photo Attendance:** Upload class photo for AI analysis
4. **View Reports:**
   - Class-wise attendance statistics
   - Student performance trends
   - Historical attendance records

### **For Students**
1. **Login** with student credentials
2. **Face Enrollment:**
   - Navigate to Face Enrollment
   - Capture 3+ face samples (different angles)
   - Verify enrollment success
3. **Mark Attendance:**
   - Navigate to Smart Attendance
   - Scan teacher's QR code
   - Allow camera and location access
   - Complete face verification
   - Confirm attendance marked
4. **View Records:**
   - Personal attendance statistics
   - Course-wise breakdown
   - Calendar view of attendance history
   - Timetable access

---

## 📊 Database Schema

### **Core Tables** (24 Migrations)

**Users & Authentication:**
- `users` - Base user accounts with roles
- `students` - Student-specific data
- `teachers` - Teacher-specific data
- `departments` - Academic departments

**Academic Structure:**
- `courses` - Course catalog
- `sections` - Class sections
- `batches` - Student batches
- `student_courses` - Course enrollments
- `teacher_courses` - Teacher assignments

**Timetable System:**
- `timetable` - Main timetable entries
- `timetable_requests` - Generation requests
- `course_sessions` - Session planning
- `generated_timetables` - AI-generated schedules
- `saved_timetables` - Saved timetable configurations

**Attendance System:**
- `attendance` - Attendance records
- `attendance_sessions` - QR sessions
- `student_faces` - Facial embeddings
- `student_scan_records` - Scan history

**Notifications & Analytics:**
- `notifications` - System notifications
- `smart_timetable_solutions` - Timetable analytics

---

## 🧪 API Documentation

### **Authentication**
```
POST   /api/auth/login          # User login
POST   /api/auth/register       # User registration
GET    /api/auth/me             # Get current user
POST   /api/auth/refresh        # Refresh token
```

### **Attendance**
```
POST   /api/attendance/                              # Mark attendance
POST   /api/attendance/bulk                          # Bulk mark
GET    /api/attendance/student/:studentId           # Student history
GET    /api/attendance/class/:scheduleId            # Class attendance
POST   /api/attendance/timetable/:id/mark           # Mark by timetable
GET    /api/attendance/unified                      # Unified view
```

### **Smart Attendance**
```
POST   /api/smart-attendance/session/start          # Start QR session
POST   /api/smart-attendance/session/:id/scan       # Student scan
POST   /api/smart-attendance/student/:id/faces      # Enroll face
GET    /api/smart-attendance/student/:id/faces      # Get faces
POST   /api/smart-attendance/session/:id/verify     # Verify attendance
```

### **Timetable**
```
POST   /api/smart-timetable/generate                # Generate timetable
GET    /api/smart-timetable/solutions/:requestId    # Get solutions
POST   /api/smart-timetable/deploy                  # Deploy timetable
GET    /api/timetable/student/:studentId            # Student timetable
GET    /api/timetable/teacher/:teacherId            # Teacher timetable
```

### **Management**
```
GET    /api/students/                               # List students
POST   /api/students/                               # Create student
POST   /api/student-enrollment/bulk                 # Bulk enrollment
GET    /api/courses/                                # List courses
POST   /api/courses/                                # Create course
GET    /api/teachers/                               # List teachers
POST   /api/teachers/                               # Create teacher
```

---

## 🔒 Security Features

- **JWT Authentication:** Secure token-based auth with expiration
- **Password Hashing:** bcrypt with salt rounds
- **Role-Based Access Control:** Granular permissions per role
- **SQL Injection Prevention:** Parameterized queries with Sequelize
- **XSS Protection:** Input sanitization and validation
- **CORS Configuration:** Restricted cross-origin requests
- **Face Data Encryption:** Facial embeddings stored securely
- **Location Verification:** GPS-based attendance validation
- **Session Timeouts:** Time-bound QR sessions (90 seconds)

---

## 📈 Performance Optimizations

- **Database Indexing:** Optimized queries with strategic indexes
- **Lazy Loading:** Component-level code splitting
- **Image Optimization:** Sharp for server-side image processing
- **Face Model Caching:** TensorFlow.js model preloading
- **Connection Pooling:** PostgreSQL connection management
- **API Rate Limiting:** Prevents abuse
- **Frontend Caching:** Service worker ready

---

## 🧩 Project Structure

```
Haazir-Smart-Attendence-Management-System/
├── client/                          # React Frontend
│   ├── public/
│   │   ├── models/                  # Face-API.js models
│   │   └── index.html
│   ├── src/
│   │   ├── components/              # React components
│   │   │   ├── common/              # Shared components
│   │   │   ├── coordinator/         # Coordinator-specific
│   │   │   ├── teacher/             # Teacher-specific
│   │   │   ├── student/             # Student-specific
│   │   │   └── landing/             # Landing page
│   │   ├── pages/                   # Page components
│   │   ├── services/                # API services
│   │   ├── hooks/                   # Custom React hooks
│   │   ├── contexts/                # React contexts
│   │   ├── types/                   # TypeScript types
│   │   ├── utils/                   # Utility functions
│   │   ├── App.tsx                  # Main app component
│   │   └── index.tsx                # Entry point
│   ├── package.json
│   └── tailwind.config.js
├── server/                          # Node.js Backend
│   ├── src/
│   │   ├── ai/                      # AI algorithms
│   │   │   ├── aiTimetableGenerator.ts
│   │   │   ├── cspSolver.ts
│   │   │   ├── hardConstraints.ts
│   │   │   └── softConstraints.ts
│   │   ├── controllers/             # Route controllers
│   │   ├── middleware/              # Express middleware
│   │   ├── models/                  # Database models
│   │   ├── routes/                  # API routes
│   │   ├── services/                # Business logic
│   │   ├── utils/                   # Helper functions
│   │   ├── types/                   # TypeScript types
│   │   └── app_clean.ts             # Express app
│   ├── package.json
│   └── tsconfig.json
├── database/                        # Database files
│   ├── migrations/                  # 24 migration files
│   │   ├── 001_create_users.sql
│   │   ├── 002_create_departments.sql
│   │   ├── ...
│   │   └── 024_fix_sections_unique_constraint.sql
│   └── seeds/                       # Seed data
│       └── sample_data.sql
└── README.md
```

---

## 🐛 Known Issues & Limitations

1. **Face Recognition Accuracy:** Lighting conditions affect recognition
2. **QR Session Timeout:** 90-second window may be tight for large classes
3. **Browser Compatibility:** Face-API.js works best on Chrome/Edge
4. **Mobile Performance:** Heavy ML models may lag on older devices
5. **Timetable Generation Time:** Complex constraints can take 10-30 seconds

---

## 🔮 Future Enhancements

- [ ] Mobile apps (React Native)
- [ ] Biometric attendance (fingerprint integration)
- [ ] Leave management system
- [ ] Parent portal and notifications
- [ ] AI-powered student performance prediction
- [ ] Multi-language support
- [ ] Exam schedule generation
- [ ] Integration with LMS platforms
- [ ] Automated report generation (PDF exports)
- [ ] Real-time notifications via WebSocket
- [ ] Offline mode support
- [ ] Cloud deployment (AWS/Azure)

---

## 📄 License

This project is licensed under the **MIT License** - see the LICENSE file for details.

---

## 👥 Team & Credits

**Developed by:** Priyanshu Chaurasia & Team  
**Institution:** IIIT Gwalior  
**Project Type:** Hackathon Project  

### **Contributors:**
- **Backend Development:** Priyanshu Chaurasia
- **Frontend Development:** Development Team
- **AI/ML Implementation:** AI Team
- **Database Design:** Database Team

### **Special Thanks:**
- Face-API.js community for facial recognition models
- TensorFlow.js team for ML framework
- Supabase for database infrastructure

---

## 📞 Contact & Support

**Issues:** [GitHub Issues](https://github.com/priyanshu-1006/Haazir-Smart-Attendence-Management-System/issues)  
**Email:** support@haazir.edu  
**Documentation:** [Wiki](https://github.com/priyanshu-1006/Haazir-Smart-Attendence-Management-System/wiki)  

---

## 🙏 Acknowledgments

Built with ❤️ using open-source technologies. Special thanks to the developer community for their amazing tools and libraries.

**⭐ If you find this project helpful, please star the repository! ⭐**
